{% extends "core/base_admin.html" %}
{% load static %}
{% block content %}
<div class="pages-main">
    <h1 class="pages-main-head">Faculty Management</h1>
    <div class="note-and-actions">
        <div class="note-text">
            <p style="color: red;"><strong>Note:</strong> Upload faculty data in <strong>.csv</strong> format.
            </p>
            <p style="color: red;">(Download the sample .csv file and add data in the specified structure to
                avoid errors)</p>
        </div>
        <div class="add-data">
            <a class="control-btn" href="#">Add new faculty</a>
            <form action="{% url 'masters:faculty_upload' %}" method="post" enctype="multipart/form-data" style="display:inline;">
                {% csrf_token %}
                <label for="uploadFile" class="control-btn" style="cursor: pointer;">Upload File</label>
                <input type="file" id="uploadFile" name="csv_file" style="display: none;" accept=".csv" onchange="this.form.submit()">
            </form>
            <a href="{% static 'samples/facultydata.csv' %}" download class="control-btn">Download Sample CSV</a>
        </div>
    </div>

    <div class="controls">
        <form onsubmit="return false;">
            <label for="search">Search Faculty:</label>
            <input type="text" id="search" placeholder="Enter Faculty name or ID" />

                        <label for="department">Department:</label>
                        <select id="department">
                                <option value="all">All Departments</option>
                                {% for dept in departments %}
                                    <option value="{{ dept.dept_code }}">{{ dept.dept_name }} ({{ dept.dept_code }})</option>
                                {% endfor %}
                        </select>
        </form>
    </div>

    <div class="actions">
        <button type="button" id="resetFacultyFilters">
            <img src="https://img.icons8.com/?size=100&id=12494&format=png&color=ffffff" alt="Reset" />
            Reset
        </button>
        <button type="button" id="printFacultyBtn">
            <img src="https://img.icons8.com/?size=100&id=85372&format=png&color=ffffff" alt="Print" />
            Print
        </button>
        <button type="button" id="downloadFacultyBtn">
            <img src="https://img.icons8.com/?size=100&id=83159&format=png&color=ffffff" alt="Download" />
            Download Data
        </button>
    </div>

    <div class="table">
        <table id="faculty-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Faculty ID</th>
                    <th>Name</th>
                    <th>Department</th>
                    <th>Mobile</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="faculty-list">
                {% for faculty in faculties %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td><a href="{% url 'masters:faculty_detail' faculty.id %}" class="faculty-action-link">{{faculty.faculty_id}}</a></td>
                    <td>{{ faculty.user.first_name }} {{ faculty.user.last_name }}</td>
                    <td>{{ faculty.dept.dept_name }} ({{ faculty.dept.dept_code }})</td>
                    <td>{{ faculty.phone_number }}</td>
                    <td>{{ faculty.user.email }}</td>
                    <td>
                        <a href="{% url 'masters:faculty_detail' faculty.id %}" class="faculty-action-link"><img src="https://img.icons8.com/?size=100&id=fdX9cvS8MtuS&format=png&color=000000" alt="View" title="View details"></a>
                        <a href="{% url 'masters:faculty_edit' faculty.id %}" class="faculty-action-link"><img src="https://img.icons8.com/?size=100&id=kzmsQM0bM3Bl&format=png&color=000000" alt="Edit" title="Edit Details"></a>
                        <button class="faculty-delete-btn"
                            data-faculty-id="{{ faculty.id }}"
                            data-faculty-name="{{ faculty.user.first_name }} {{ faculty.user.last_name }}"
                            data-faculty-email="{{ faculty.user.email }}"
                            data-faculty-dept="{{ faculty.dept.dept_name }}"
                            data-faculty-phone="{{ faculty.phone_number }}"
                            data-faculty-designation="{{ faculty.designation }}"
                            data-faculty-status="{{ faculty.status }}"
                            style="background:none;border:none;padding:0;cursor:pointer;">
                            <img src="https://img.icons8.com/?size=100&id=99971&format=png&color=000000" alt="Delete" title="Delete Faculty">
                        </button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7">No courses found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>


<!-- Faculty Delete Modal using AJAX -->
<div id="facultyDeleteModal" class="modal" style="display:none;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(30,58,95,0.18);z-index:1000;">
    <div class="modal-content" id="facultyDeleteModalContent" style="background:transparent;padding:0;border-radius:14px;max-width:480px;width:100%;box-shadow:none;position:relative;">
        <!-- Content will be loaded here -->
    </div>
</div>

<script src="{% static 'js/scripts.js' %}"></script>
{% endblock %}