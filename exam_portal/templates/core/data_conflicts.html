{% extends 'core/base_admin.html' %}
{% block content %}
<h2>Data Conflict Detected</h2>
<p>The following records in your CSV already exist in the database but do not match exactly. Please review the mismatched data below:</p>
{% for row, db_row in mismatches %}
<div class="conflict-block" style="margin-bottom: 32px; border: 1px solid #f59e42; border-radius: 8px; padding: 18px;">
    <h4 style="margin-bottom: 12px;">Conflict for: <b>{{ row.0 }}</b></h4>
    <table class="table table-bordered" style="width: 100%;">
        <thead>
            <tr style="background: #f8fafc;">
                <th>Field</th>
                <th>Old Value</th>
                <th>New Value</th>
            </tr>
        </thead>
        <tbody>
            {% for idx in headers|length|make_list %}
                {% with field=headers|index:forloop.counter0 %}
                <tr>
                    <td>{{ field }}</td>
                    <td>{{ db_row|index:forloop.counter0 }}</td>
                    <td>{{ row|index:forloop.counter0 }}</td>
                </tr>
                {% endwith %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endfor %}
<p class="text-danger">Please resolve these conflicts before re-uploading.</p>
<a href="{% url 'core:settings' %}" class="btn btn-primary">Back to Settings</a>
{% endblock %}
