{% extends "core/base_admin.html" %}
{% load static %}
{% block content %}
<div class="pages-main">
	<h1 class="pages-main-head">Room Allocation Details</h1>
	<div class="note-text">
		<p style="color: #2C4C70;">Room allocation details for selected exam slot.</p>
	</div>
	<div class="controls-1" style="display: flex; flex-wrap: wrap; gap: 20px; background: #f8fafc; border-radius: 12px;margin-bottom: 5px;">
		<div class="readonly-field" style="min-width: 220px;"><label>Exam Name:</label> <span>{{ slot.examination.exam_name }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Exam Type:</label> <span>{{ slot.exam_type }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Mode:</label> <span>{{ slot.mode }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Exam Date:</label> <span>{{ slot.exam_date }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Start Time:</label> <span>{{ slot.start_time }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>End Time:</label> <span>{{ slot.end_time }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Slot Code:</label> <span>{{ slot.slot_code }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Academic Year:</label> <span>{{ slot.examination.academic_year }}</span></div>
		<div class="readonly-field" style="min-width: 220px;"><label>Semester:</label> <span>{{ slot.examination.semester }}</span></div>
	</div>
	<div class="student-count">
		<b>Student Count:</b> {{ student_count }}
	</div>
	<div class="rooms-table-section">
		<h3>Available Rooms</h3>
		<form method="post" action="">
			{% csrf_token %}
			<div style="max-height: 425px; overflow-y: auto;">
				<table class="table" style="min-width:600px;">
					<thead style="position:sticky; top:0; background:#f8fafc; z-index:2;">
						<tr>
							<th>Select</th>
							<th>Room Code</th>
							<th>Type</th>
							<th>Block</th>
							<th>Capacity</th>
						</tr>
					</thead>
					<tbody>
						{% for room in rooms %}
						<tr>
							<td><input type="checkbox" name="selected_rooms" value="{{ room.id }}" {% if room.id in allocated_room_ids %}checked{% endif %}></td>
							<td>{{ room.room_code }}</td>
							<td>{{ room.room_type }}</td>
							<td>{{ room.block }}</td>
							<td>{{ room.capacity }}</td>
						</tr>
						{% empty %}
						<tr><td colspan="5" style="text-align:center;">No rooms available.</td></tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			<button type="submit" class="control-btn">Allocate Selected Rooms</button>
		</form>
	</div>
</div>
{% endblock %}
